**An Optimal Algorithm for CTGTG**  

In this section, we present an optimal algorithm for the CTGTG. We use Observation 3 in the idea of this algorithm. In each step of our algorithm, we add a vertex <img src="https://tex.s2cms.ru/svg/v_i" alt="v_i" /> to our result <img src="https://tex.s2cms.ru/svg/S" alt="S" /> such that if <img src="https://tex.s2cms.ru/svg/v_i%20%5Cnotin%20OPT" alt="v_i \notin OPT" /> then <img src="https://tex.s2cms.ru/svg/v_i" alt="v_i" /> can replace a vertex <img src="https://tex.s2cms.ru/svg/v_j%20%5Cin%20OPT" alt="v_j \in OPT" /> and <img src="https://tex.s2cms.ru/svg/%7CS%7C%3D%7COPT%7C" alt="|S|=|OPT|" />.  
**Observation 3** *The optimal solution of the CTGTG includes <img src="https://tex.s2cms.ru/svg/v_1" alt="v_1" /> and <img src="https://tex.s2cms.ru/svg/v_n" alt="v_n" />*.  

&nbsp;&nbsp;&nbsp;&nbsp;This is because in the CTGTG for right-guarded and left-guaded T, only <img src="https://tex.s2cms.ru/svg/v_1" alt="v_1" /> can left-guard <img src="https://tex.s2cms.ru/svg/v_1" alt="v_1" /> and only <img src="https://tex.s2cms.ru/svg/v_n" alt="v_n" /> can right-guard <img src="https://tex.s2cms.ru/svg/v_n" alt="v_n" />.  
**Lemma 3** <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)" alt="R(N_i^R)" /> and any guard in <img src="https://tex.s2cms.ru/svg/O_R(N_i%5ER)" alt="O_R(N_i^R)" /> do not lie on the right side of <img src="https://tex.s2cms.ru/svg/o_i" alt="o_i" />.  

**Proof.** Let <img src="https://tex.s2cms.ru/svg/x" alt="x" /> be a point on the edge <img src="https://tex.s2cms.ru/svg/e_%7Bj-1%7D" alt="e_{j-1}" /> such that <img src="https://tex.s2cms.ru/svg/N_i%5ER%20%5Cprec%20x" alt="N_i^R \prec x" />. We assume that <img src="https://tex.s2cms.ru/svg/v_j%20%5Cin%20R(N_i%5ER)%20%5Ccup%20O_R(N_i%5ER)" alt="v_j \in R(N_i^R) \cup O_R(N_i^R)" /> is on the right side of <img src="https://tex.s2cms.ru/svg/o_i" alt="o_i" />. We know that x is right-guarded by <img src="https://tex.s2cms.ru/svg/o_k" alt="o_k" /> and <img src="https://tex.s2cms.ru/svg/o_k" alt="o_k" /> is on the right side of <img src="https://tex.s2cms.ru/svg/v_j" alt="v_j" />. ACcording to Lemma 1, if <img src="https://tex.s2cms.ru/svg/o_k" alt="o_k" /> right-guards x, then <img src="https://tex.s2cms.ru/svg/N_i%5ER" alt="N_i^R" /> is right-guarded by <img src="https://tex.s2cms.ru/svg/o_k" alt="o_k" />. This contadicts the definition of <img src="https://tex.s2cms.ru/svg/N_i%5ER" alt="N_i^R" /> and <img src="https://tex.s2cms.ru/svg/o_k" alt="o_k" /> sees <img src="https://tex.s2cms.ru/svg/N_i%5ER" alt="N_i^R" />. The schematic of Lemma 3 is given in Fig 5. <img src="https://tex.s2cms.ru/svg/%5Cblacksquare" alt="\blacksquare" />  

**Lemma 4** If <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)%20%5Cnotin%20O_R(N_i%5ER)" alt="R(N_i^R) \notin O_R(N_i^R)" />, then any guard in <img src="https://tex.s2cms.ru/svg/O_R(N_i%5ER)" alt="O_R(N_i^R)" /> cannot left-guard <img src="https://tex.s2cms.ru/svg/x%5E%7B%5Cprime%7D%20%5Cin%20%5C%7Bx%20%5Cin%20X%7CR(N_i%5ER)%20%5Cprec%20x%5C%7D" alt="x^{\prime} \in \{x \in X|R(N_i^R) \prec x\}" />.  
**Proof.** Let g be a guad in <img src="https://tex.s2cms.ru/svg/O_R(N_i%5ER)%20%5Cbackslash%20R(N_i%5ER)" alt="O_R(N_i^R) \backslash R(N_i^R)" /> and let <img src="https://tex.s2cms.ru/svg/x%5E%5Cprime" alt="x^\prime" /> be a point such that <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)%20%5Cprec%20x%5E%5Cprime" alt="R(N_i^R) \prec x^\prime" />. Therefore, <img src="https://tex.s2cms.ru/svg/N_i%5ER%20%5Cprec%20g%20%5Cprec%20R(N_i%5ER)%20%5Cprec%20x%5E%5Cprime" alt="N_i^R \prec g \prec R(N_i^R) \prec x^\prime" />. Consider <img src="https://tex.s2cms.ru/svg/x%5E%5Cprime" alt="x^\prime" /> on the edge <img src="https://tex.s2cms.ru/svg/e_k%20%3D%20%5Coverline%7Bv_kv_%7Bk%2B1%7D%7D" alt="e_k = \overline{v_kv_{k+1}}" />, there exists a guard <img src="https://tex.s2cms.ru/svg/o_j" alt="o_j" /> that right-guards <img src="https://tex.s2cms.ru/svg/x%5E%5Cprime" alt="x^\prime" />. We can conclude from Lemma 1, if <img src="https://tex.s2cms.ru/svg/x%5E%5Cprime" alt="x^\prime" /> and g see each otehr, then <img src="https://tex.s2cms.ru/svg/x%5E%5Cprime" alt="x^\prime" /> and <img src="https://tex.s2cms.ru/svg/N_i%5ER" alt="N_i^R" /> also see each other. This is illustrated in Fig. 6. Because <img src="https://tex.s2cms.ru/svg/o_j" alt="o_j" /> right-guards <img src="https://tex.s2cms.ru/svg/x%5E%5Cprime" alt="x^\prime" /> and sees <img src="https://tex.s2cms.ru/svg/v_k" alt="v_k" />, if <img src="https://tex.s2cms.ru/svg/x%5E%5Cprime" alt="x^\prime" /> sees <img src="https://tex.s2cms.ru/svg/N_i%5ER" alt="N_i^R" /> then <img src="https://tex.s2cms.ru/svg/o_j" alt="o_j" /> right-guard <img src="https://tex.s2cms.ru/svg/N_i%5ER" alt="N_i^R" /> too, as illustrated in Fig. 7. <img src="https://tex.s2cms.ru/svg/%5Cblacksquare" alt="\blacksquare" />  
**Lemma 5** If <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)%20%5Cnotin%20O_R(N_i%5ER)%2C%20x%20%5Cin%20X" alt="R(N_i^R) \notin O_R(N_i^R), x \in X" /> is right-guarded by <img src="https://tex.s2cms.ru/svg/o_j" alt="o_j" />  and <img src="https://tex.s2cms.ru/svg/j%20%5Cleq%20j%20%5Cleq%20m" alt="j \leq j \leq m" />, then x cannot lie between <img src="https://tex.s2cms.ru/svg/g%20%5Cin%20O_R(N_i%5ER)" alt="g \in O_R(N_i^R)" /> and <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)" alt="R(N_i^R)" />.  
**Proof.** We assume that the point x is on the <img src="https://tex.s2cms.ru/svg/e_k%3Dv_kR(N_i%5ER)" alt="e_k=v_kR(N_i^R)" /> and x is right-guarded by <img src="https://tex.s2cms.ru/svg/o_j" alt="o_j" />. We know that <img src="https://tex.s2cms.ru/svg/o_j" alt="o_j" /> right-guarded <img src="https://tex.s2cms.ru/svg/v_k" alt="v_k" /> by Observation 2. According to Lemma 1, if x is right-guarded by <img src="https://tex.s2cms.ru/svg/o_j" alt="o_j" />, then <img src="https://tex.s2cms.ru/svg/N_R(o_i)" alt="N_R(o_i)" /> is right-guarded by <img src="https://tex.s2cms.ru/svg/o_j" alt="o_j" />. Hence, x cannot lie between <img src="https://tex.s2cms.ru/svg/g%20%5Cin%20O_R(N_i%5ER)" alt="g \in O_R(N_i^R)" /> and <img src="https://tex.s2cms.ru/svg/R(N_R(o_i))" alt="R(N_R(o_i))" /> if <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)%20%5Cnotin%20O_R(N_i%5ER)" alt="R(N_i^R) \notin O_R(N_i^R)" />.  
By Lemma 3, Lemma 4 and Lemma 5, we have the following theorem.  

**Theorem 6** If <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)%20%5Cnotin%20O_R(N_i%5ER)" alt="R(N_i^R) \notin O_R(N_i^R)" />, then <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)" alt="R(N_i^R)" /> can replace any guard in <img src="https://tex.s2cms.ru/svg/O_R(N_i%5ER)" alt="O_R(N_i^R)" />.  

**Proof.** We use Lemma 3, Lemma 4, and Lemma 5 <img src="https://tex.s2cms.ru/svg/g%20%5Cin%20O_R(N_i%5ER)" alt="g \in O_R(N_i^R)" /> cannot left-guard <img src="https://tex.s2cms.ru/svg/x_k%20%5Cin%20%5C%7Bx_j%20%7C%20N_i%5ER%20%5Cprec%20x_j%5C%7D" alt="x_k \in \{x_j | N_i^R \prec x_j\}" /> if <img src="https://tex.s2cms.ru/svg/R(N_i%5ER)%20%5Cnotin%20O_R(N_i%5ER)" alt="R(N_i^R) \notin O_R(N_i^R)" />. Due to <img src="https://tex.s2cms.ru/svg/g%20%5Cprec%20R(N_i%5ER)" alt="g \prec R(N_i^R)" />, we know <img src="https://tex.s2cms.ru/svg/vis(R(N_i%5ER))%20%5Csupseteq%20vis(g)" alt="vis(R(N_i^R)) \supseteq vis(g)" /> by Lemma 1. <img src="https://tex.s2cms.ru/svg/%5Cblacksquare" alt="\blacksquare" />  

&nbsp; &nbsp; &nbsp; &nbsp; Similarly, <img src="https://tex.s2cms.ru/svg/L(N_i%5EL)" alt="L(N_i^L)" /> can replace any guard in <img src="https://tex.s2cms.ru/svg/O_L(N_i%5EL)" alt="O_L(N_i^L)" />.  

**Theorem 7** If <img src="https://tex.s2cms.ru/svg/O(N_i%5EL)%20%5Cnotin%20L(N_i%5EL)" alt="O(N_i^L) \notin L(N_i^L)" />, then <img src="https://tex.s2cms.ru/svg/L(N_i%5EL)" alt="L(N_i^L)" /> can replace any guard in <img src="https://tex.s2cms.ru/svg/O_L(N_i%5EL)" alt="O_L(N_i^L)" />.  

